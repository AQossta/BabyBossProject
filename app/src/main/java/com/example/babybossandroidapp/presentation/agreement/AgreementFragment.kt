package com.example.babybossandroidapp.presentation.agreement

import android.os.Bundle
import androidx.fragment.app.Fragment
import android.view.LayoutInflater
import android.view.View
import android.view.ViewGroup
import androidx.navigation.fragment.findNavController
import com.example.babybossandroidapp.databinding.FragmentAgreementBinding

class AgreementFragment : Fragment() {

    private var _binding: FragmentAgreementBinding? = null
    private val binding get() = _binding!!

    override fun onCreateView(
        inflater: LayoutInflater,
        container: ViewGroup?,
        savedInstanceState: Bundle?
    ): View {
        _binding = FragmentAgreementBinding.inflate(inflater, container, false)
        return binding.root
    }

    override fun onViewCreated(view: View, savedInstanceState: Bundle?) {
        super.onViewCreated(view, savedInstanceState)

//        val agreementType = arguments?.getString("agreement_type") ?: "user_agreement"
        setupAgreementText("user_agreement")
        setupBackButton()
    }

    private fun setupBackButton() {
        binding.toolbarBack.btnBack.setOnClickListener{
            findNavController().popBackStack()
        }
    }

    private fun setupAgreementText(type: String) {
        val agreementText = when (type) {
            "personal_data" -> getPersonalDataText()
            "privacy_policy" -> getPrivacyPolicyText()
            "user_agreement" -> getUserAgreementText()
            else -> getUserAgreementText()
        }

        binding.agreementTextView.text = agreementText
    }

    private fun getPersonalDataText(): String {
        return """
            ПОЛИТИКА СБОРА И ОБРАБОТКИ ПЕРСОНАЛЬНЫХ ДАННЫХ

            1. ОБЩИЕ ПОЛОЖЕНИЯ
            1.1. Настоящая Политика определяет порядок обработки персональных данных пользователей мобильного приложения «[Название приложения]».
            
            2. СОБИРАЕМЫЕ ДАННЫЕ
            2.1. Мы собираем следующие персональные данные:
            • ФИО родителя/законного представителя
            • Номер телефона
            • Email адрес
            • Данные ребенка (ФИО, дата рождения)
            • Адреса маршрута перевозки
            
            3. ЦЕЛИ ОБРАБОТКИ
            3.1. Персональные данные обрабатываются для:
            • Оказания услуг по перевозке детей
            • Связи с пользователем
            • Обеспечения безопасности перевозок
        """.trimIndent()
    }

    private fun getPrivacyPolicyText(): String {
        return """
            ПОЛИТИКА КОНФИДЕНЦИАЛЬНОСТИ

            1. ЗАЩИТА ДАННЫХ
            1.1. Мы обеспечиваем конфиденциальность и безопасность персональных данных пользователей.
            
            2. ПЕРЕДАЧА ДАННЫХ
            2.1. Мы не передаем персональные данные третьим лицам, за исключением случаев, предусмотренных законодательством.
        """.trimIndent()
    }

    private fun getUserAgreementText(): String {
        return """
            ДОГОВОР ОКАЗАНИЯ УСЛУГ ПО ПЕРЕВОЗКЕ НЕСОВЕРШЕННОЛЕТНЕГО РЕБЁНКА

            г. [Город] [Дата заключения договора]

            [Наименование компании-перевозчика], именуемое в дальнейшем «Исполнитель», в лице [ФИО руководителя], действующего на основании [Устава/Доверенности], с одной стороны, и [ФИО родителя/законного представителя], именуемый в дальнейшем «Заказчик», в лице Пользователя мобильного приложения «[Название приложения]», с другой стороны, совместно именуемые «Стороны», заключили настоящий Договор о нижеследующем.

            1. ПРЕДМЕТ ДОГОВОРА

            1.1. Исполнитель обязуется оказать услуги по регулярной перевозке несовершеннолетнего ребёнка — [ФИО ребёнка], [Дата рождения ребёнка], (далее — «Ребёнок») по установленному маршруту, а Заказчик обязуется оплатить эти услуги в порядке и на условиях, предусмотренных настоящим Договором.

            1.2. Перевозка осуществляется по маршруту:
            Из дома в школу: [Адрес отправления] — [Адрес школы].
            Из школы домой: [Адрес школы] — [Адрес возвращения].

            1.3. График оказания услуг:
            Утренний рейс: [Укажите время отправления, например: в будние дни с понедельника по пятницу, отправление в [Время]].
            Вечерний рейс: [Укажите время возвращения, например: в будние дни с понедельника по пятницу, отправление в [Время]].
            Дни недели: [Например: Понедельник — Пятница].

            2. ПРАВА И ОБЯЗАННОСТИ СТОРОН

            2.1. Исполнитель обязуется:
            • Обеспечить безопасную и своевременную перевозку Ребёнка в соответствии с маршрутом и графиком.
            • Предоставить для перевозки транспортное средство, соответствующее требованиям безопасности и санитарным нормам.
            • Назначить для перевозки водителя, имеющего необходимую квалификацию, опыт и прошедшего проверку.
            • Использовать детские удерживающие устройства, соответствующие возрасту и весу Ребёнка.
            • Информировать Заказчика через мобильное приложение о начале и завершении каждого рейса, а также о любых задержках или непредвиденных обстоятельствах.

            2.2. Заказчик обязуется:
            • Обеспечить готовность Ребёнка к отправлению в установленное время.
            • Передать Ребёнка водителю лично или через уполномоченное лицо.
            • Своевременно информировать Исполнителя о любых изменениях в расписании или об отмене поездки не менее чем за [Например: 2 часа] до начала рейса.
            • Оплачивать услуги в полном объёме и в установленный срок.
            • Предоставить Исполнителю достоверные контактные данные для экстренной связи.

            2.3. Заказчик имеет право:
            • Получать информацию о местонахождении транспортного средства в реальном времени через мобильное приложение.
            • Отменить поездку с учётом условий, указанных в п. 2.2.
            • Предоставлять свои пожелания и замечания относительно качества предоставляемых услуг.

            3. СТОИМОСТЬ УСЛУГ И ПОРЯДОК ОПЛАТЫ

            3.1. Стоимость услуг устанавливается в соответствии с тарифами, действующими в мобильном приложении «[Название приложения]» на момент заключения Договора и выбранного Заказчиком тарифа ([Ежедневный, Недельный, Месячный]).

            3.2. Оплата производится [Укажите способ оплаты: например, безналичным расчётом через мобильное приложение путём списания средств с привязанной банковской карты].

            3.3. При отмене поездки Заказчиком менее чем за [Например: 2 часа] до начала рейса, Исполнитель имеет право удержать [Например: 50% от стоимости поездки] в качестве компенсации.

            4. ОТВЕТСТВЕННОСТЬ СТОРОН

            4.1. Стороны несут ответственность за неисполнение или ненадлежащее исполнение своих обязательств в соответствии с законодательством [Название страны] и условиями настоящего Договора.

            4.2. Исполнитель несёт ответственность за жизнь и здоровье Ребёнка с момента его приёма до момента передачи Заказчику или уполномоченному им лицу.

            4.3. Исполнитель не несёт ответственности за задержки, возникшие по независящим от него причинам (дорожные пробки, погодные условия и т.д.), но обязуется своевременно уведомить Заказчика о таких обстоятельствах.

            5. СРОК ДЕЙСТВИЯ ДОГОВОРА

            5.1. Настоящий Договор вступает в силу с момента его акцепта Заказчиком в мобильном приложении и действует [Например: до момента отказа одной из сторон от услуг/на срок действия выбранного тарифа].

            5.2. Договор считается продлённым на следующий период в случае [Например: автоматического списания средств за следующий период].

            6. ПРОЧИЕ УСЛОВИЯ

            6.1. Все споры и разногласия, возникающие в процессе исполнения настоящего Договора, разрешаются путём переговоров. При недостижении согласия споры передаются на рассмотрение в суд в соответствии с законодательством [Название страны].

            6.2. Настоящий Договор заключается в электронной форме путём акцепта Заказчиком его условий в мобильном приложении.

            [РЕКВИЗИТЫ ИСПОЛНИТЕЛЯ]
            Наименование: [Наименование компании]
            ИНН: [Номер]
            Юридический адрес: [Адрес]
            Банковские реквизиты: [Номер счёта, БИК, Наименование банка]
            Контактные данные: [Телефон, Email]

            [ДАННЫЕ ЗАКАЗЧИКА]
            ФИО: [ФИО родителя/законного представителя]
            Номер телефона: [Номер телефона, привязанный к аккаунту в приложении]
            Email: [Email, привязанный к аккаунту в приложении]
        """.trimIndent()
    }

    override fun onDestroyView() {
        super.onDestroyView()
        _binding = null
    }
}